#!/bin/bash -e

case "$1" in
  --help|-h)
    echo "usage: $(basename "$0") [<parent branch>] [<path>]" >&2
    exit 1
    ;;
  *)
    FIRST_COMMIT="$(diff -u <(git rev-list --first-parent HEAD) <(git rev-list --first-parent "${1:-master}") | sed -ne 's/^ //p' | head -1)"
    git diff --name-only "HEAD..$FIRST_COMMIT" "${2:-.}"
    ;;
esac
